$(document).ready(function(){var itemStartTime=2018,noItemPrompt="你提供的关键字太罕见了，没有相关节目，再试试别的~？",seachPrompt="请输入搜素关键字",coverItem="images/cover.jpg",song=[{cover:"images/cover.jpg",src:"",title:"sdfas"}];InitAllYear();var audioFn=audioPlay({song:song,autoPlay:!1});function InitAllYear(){var nowYear=(new Date).getFullYear();$("#currentyear").text(nowYear+"年"),$(".mccYear").text(nowYear+"年"),InitAllMonth(nowYear);for(var ulObj=$("#allyear"),i=itemStartTime;i<=nowYear;i++)ulObj.append("<li value="+i+"><a>"+i+"年</a></li>")}function InitAllMonth(currentyear){var aObjs=$("#collapseyear").find("a.mccMonth"),length=aObjs.length;for(i=0;i<aObjs.length;i++)aObjs[i].text="";var currentDate=new Date,currentMonth=currentDate.getMonth()+1;currentyear<currentDate.getFullYear()&&(currentMonth=12);for(var i=0;i<currentMonth;i++){var strTemp=currentyear+"0"+(i+1);i+1>9&&(strTemp=currentyear+""+(i+1)),aObjs[i].text=strTemp}}function showNoItemPrompt(isshow){isshow?$(".noitemprompt").show().text(noItemPrompt):$(".noitemprompt").hide()}function toggleLoadingControls(loading){loading?$(".spinner").show():$(".spinner").hide()}function getSwtyItemsData(valuesDate){var server="http://api.swtychina.com/api/values?";$(".audio-inline").empty(),toggleLoadingControls(!0),showNoItemPrompt(!1),$.ajax({url:server+valuesDate,type:"GET",dataType:"json",timeout:1e4,error:function(data){alert("加载数据失败，再次点击试试~？"),toggleLoadingControls(!1)},success:function(data){toggleLoadingControls(data.length),song.splice(0,song.length);var parent=document.getElementById("ProgramList"),auditonUrl="http://swtychina.com/gb/audiodoc";$.each(data,function(index,val){var year=val.date.substring(0,4),month=year+val.date.substring(5,7),day=month+val.date.substring(8,10),Url=auditonUrl+"/"+year+"/"+month+"/"+day+".mp3",mccItemTitle=val.title,item={date:val.date,url:Url,title:mccItemTitle},itemDate=new Date(val.date.substring(0,4),val.date.substring(5,7)-1,val.date.substring(8,10)),todayDate=new Date,startDate=new Date(2018,0,1),weekday=itemDate.getDay();itemDate<=todayDate&&itemDate>=startDate&&(1==weekday||3==weekday)&&audioFn.newSong({cover:coverItem,src:item.url,title:val.date+" "+item.title},!1)}),showNoItemPrompt(!audioFn.song.length),0!=audioFn.song.length?(audioFn.selectMenu(0,!1),audioFn.stopAudio(),isLoadLatestItem=!1,toggleLoadingControls(!1)):toggleLoadingControls(!1)}})}function SearchItem(){var itemnameObj,input_value=$("#itemname").val(),search_value;0!=$("#itemname").val().length&&getSwtyItemsData("date="+input_value)}isLoadLatestItem=!0,getSwtyItemsData(),$("#allyear > li").click(function(){var currentyear=this.value+"年";$("#currentyear").text(currentyear),$(".mccYear").text(currentyear),InitAllMonth(this.value)}),$(".mccMonth").click(function(){var yearmonth=this.text;getSwtyItemsData("date="+yearmonth.substring(0,4)+"-"+yearmonth.substring(4,6))}),$("#searchBtn").click(function(){SearchItem()}),$("#itemname").focus(function(){$("#itemname").keydown(function(event){13==event.which&&(SearchItem(),event.preventDefault())})})});